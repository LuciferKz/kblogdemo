<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>导出数据报表</title>
</head>
<body>
  <div>
    项目名：<input id="projectName" type="text">
    <button id="detail">查看</button>
    <button id="export">导出</button>
  </div>
  <div class="content"></div>
  <script>
    const qsStringify = function (d) {
      let strs = [];
      for (let name in d) {
        strs.push(name + '=' + d[name]);
      }
      return strs.join('&');
    }

    const request = function (options) {
      // let baseUrl = 'http://projects.zhangzhenkai.com/';
      let baseUrl = 'http://localhost:7150/'
      let url = `${baseUrl}${options.url}`;
      const method = options.method;
      const config = {};
      config.method = method || 'get';
      if (method.toUpperCase() === 'POST') {
        config.body = JSON.stringify(options.data);
        // config.body = qsStringify(options.data);
      }
      if (options.params) url = url + '?' + qsStringify(options.params);
      config.headers = new Headers({
        'Content-Type': 'application/json'
        // 'Content-Type': 'multipart/form-data'
        // 'Content-Type': 'application/x-www-form-urlencoded'
      })

      return new Promise((resolve, reject) => {
        fetch(url, config)
        .then(response => {
          response.json().then(res => {
            resolve(res);
          })
        })
        .catch(res => {
          reject(res);
        })
      })
    }
    const getData = function () {
      return request({
        url: 'query',
        method: 'get',
        params: { projectName: document.getElementById('projectName').value, type: '1' },
      })
    }
    document.getElementById('detail').onclick = function () {
      getData().then(res => {
        if (res.code === 20001) {
          alert(res.message)
        }
      })
    }
    document.getElementById('export').onclick = function () {

    }
  </script>
</body>
</html>
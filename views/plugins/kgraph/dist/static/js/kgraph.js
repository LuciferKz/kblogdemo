!function(n){var r={};function i(t){if(r[t])return r[t].exports;var e=r[t]={i:t,l:!1,exports:{}};return n[t].call(e.exports,e,e.exports,i),e.l=!0,e.exports}i.m=n,i.c=r,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=5)}([function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var o=function(t){var e=r(t);return null!==t&&"object"===e||"function"===e},i=function(t,e){return{}.toString.call(t)==="[object ".concat(e,"]")},u=function(t){return i(t,"Array")},a=function(t,e){if(t)if(u(t))for(var n=0,r=t.length;n<r&&!1!==e(t[n],n);n++);else if(o(t))for(var i in t)if(t.hasOwnProperty(i)&&!1===e(t[i],i))break};function s(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var c=function(){var t=Array.from(arguments),e=t.shift();return Object.assign?Object.assign.apply(Object,[e].concat(s(t))):Y.each(t,function(t){!function(t,e){for(var n in e)t[n]=e[n]}(e,t)}),e};function f(t){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var l=function t(e){if("object"!==f(e)||null===e)return e;var n;if(u(e)){n=[];for(var r=0,i=e.length;r<i;r++)"object"===f(e[r])&&null!=e[r]?n[r]=t(e[r]):n[r]=e[r]}else for(var o in n={},e)"object"===f(e[o])&&null!=e[o]?n[o]=t(e[o]):n[o]=e[o];return n},h=n(3),y=n.n(h);function p(t){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var g=function(t){return"object"===p(t)&&null!==t},v=function(t){if(!g(t)||!i(t,"Object"))return!1;if(null===Object.getPrototypeOf(t))return!0;for(var e=t;null!==Object.getPrototypeOf(e);)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e},d=function t(e,n,r,i){for(var o in r=r||0,i=i||5,n)if(n.hasOwnProperty(o)){var a=n[o];null!==a&&v(a)?(v(e[o])||(e[o]={}),r<i?t(e[o],a,r+1,i):e[o]=n[o]):u(a)?(e[o]=[],e[o]=e[o].concat(a)):void 0!==a&&(e[o]=a)}},b=function(){for(var t=new Array(arguments.length),e=t.length,n=0;n<e;n++)t[n]=arguments[n];for(var r=t[0],i=1;i<e;i++)d(r,t[i]);return r},m=function(t){return i(t,"Function")},x=Object.keys?function(t){return Object.keys(t)}:function(n){var r=[];return a(n,function(t,e){m(n)&&"prototype"===e||r.push(e)}),r},_=function(t){return null==t};var w=function(t,e){var n=x(e),r=n.length;if(_(t))return!r;for(var i=0;i<r;i+=1){var o=n[i];if(e[o]!==t[o]||!(o in t))return!1}return!0};var k=function(t,e){var n;if(m(e)&&(n=e),v(e)&&(n=function(t){return w(t,e)}),n)for(var r=0;r<t.length;r+=1)if(n(t[r]))return t[r];return null},S=function(t,n,e){if(!u(t)&&!v(t))return t;var r=e;return a(t,function(t,e){r=n(r,t,e)}),r};function O(t){return(O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var P="object"===("undefined"==typeof HTMLElement?"undefined":O(HTMLElement))?function(t){return t instanceof HTMLElement}:function(t){return t&&"object"===O(t)&&1===t.nodeType&&"string"==typeof t.nodeName},j=function(t){return null!==t&&"function"!=typeof t&&isFinite(t.length)},M=function(t){return"string"==typeof t},E={}.toString,C=function(t){return E.call(t).replace(/^\[object /,"").replace(/\]$/,"")},I=Object.prototype,D=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||I)},z=Object.prototype.hasOwnProperty;var T=function(t){if(_(t))return!0;if(j(t))return!t.length;var e=C(t);if("Map"===e||"Set"===e)return!t.size;if(D(t))return!Object.keys(t).length;for(var n in t)if(z.call(t,n))return!1;return!0},A={isDom:P,isArray:u,isArrayLike:j,isString:M,isObjectLike:g,isPlainObject:v,isFunction:m,isEmpty:T,isNil:_,isPrototype:D,getType:C},R=function(t,e){return(t%e+e)%e};var B=function(t){return j(t)?Array.prototype.slice.call(t):[]},W=function(t){for(var e=B(arguments),n=1;n<e.length;n++){var r=e[n];m(r)&&(r=r.prototype),y()(t.prototype,r)}},L=function(t){return t.charAt(0).toUpperCase()+t.slice(1)},X={find:k,reduce:S,each:a,extend:c,clone:l,mix:y.a,deepMix:b,mod:R,augment:W,toArray:B,toUpperFirst:L};y()(X,A);var Y=e.a=X},function(t,e){var a={};a.length=function(t){var e=t[0],n=t[1];return Math.sqrt(e*e+n*n)},a.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},a.angle=function(t,e){var n,r,i,o=a.dot(t,e)/(a.length(t)*a.length(e));return Math.acos((n=o)<(r=-(i=1))?r:i<n?i:n)},a.direction=function(t,e){return t[0]*e[1]-e[0]*t[1]},a.angleTo=function(t,e,n){var r=a.angle(t,e),i=0<=a.direction(t,e);return n?i?2*Math.PI-r:r:i?r:2*Math.PI-r},a.vertical=function(t,e,n){return t[1]=n?(t[0]=e[1],-1*e[0]):(t[0]=-1*e[1],e[0]),t},a.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]},a.normalize=function(t,e){var n=e[0],r=e[1],i=n*n+r*r;return 0<i&&(i=1/Math.sqrt(i),t[0]=e[0]*i,t[1]=e[1]*i),t},a.squaredDistance=function(t,e){var n=e[0]-t[0],r=e[1]-t[1];return n*n+r*r},a.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t},a.distance=function(t,e){var n=e[0]-t[0],r=e[1]-t[1];return Math.sqrt(n*n+r*r)},t.exports=a},function(t,e,n){"use strict";var o=n(0);function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var a=function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this._cfg=o.a.mix(this.getDefaultCfg(),t),this.set("style",this.getShapeStyle())}var t,n,r;return t=e,(n=[{key:"draw",value:function(){}},{key:"set",value:function(t,e){o.a.isPlainObject(t)?this._cfg=o.a.mix({},this._cfg,t):this._cfg[t]=e}},{key:"get",value:function(t){return this._cfg[t]}},{key:"updatePosition",value:function(t,e){this._cfg.x=t,this._cfg.y=e}},{key:"update",value:function(t){this._cfg=o.a.deepMix(this._cfg,t),this.set("style",this.getShapeStyle())}},{key:"getDefaultCfg",value:function(){return{x:0,y:0,size:10}}}])&&i(t.prototype,n),r&&i(t,r),e}(),u=function(t,e,n){!function(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:5;t.moveTo(e[0].x,e[0].y);for(var r=1,i=e.length;r<i;r++){var o=e[r],a=e[r+1];a||(a=e[0]),t.arcTo(o.x,o.y,a.x,a.y,n)}}(t,e,n)};function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function c(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var h=function(t,e,n){!function(t,e,n,r,i,o,a,u,s){a=void 0!==(o=void 0!==o?o:30)?a:10,u=void 0!==u?u:1,s="color"!=typeof s?s:"#000";var c=180*Math.atan2(n-i,e-r)/Math.PI,f=(c+o)*Math.PI/180,l=(c-o)*Math.PI/180,h=a*Math.cos(f),y=a*Math.sin(f),p=a*Math.cos(l),g=a*Math.sin(l);t.save(),t.beginPath();var v=e-h,d=n-y;t.moveTo(v,d),v=r+h,d=i+y,t.moveTo(v,d),t.lineTo(r,i),v=r+p,d=i+g,t.lineTo(v,d),t.fillStyle=s,t.lineWidth=u,t.closePath(),t.fill(),t.restore()}(t,e[0].x,e[0].y,e[1].x,e[1].y,30,20,n.lineWidth,n.color)};function y(t){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function p(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function g(t,e){return!e||"object"!==y(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function v(t){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function d(t,e){return(d=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var b=function(t,e){t.moveTo(e[0].x,e[0].y);for(var n=1,r=e.length;n<r;n++)t.lineTo(e[n].x,e[n].y)};function m(t){return(m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function x(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _(t,e){return!e||"object"!==m(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function w(t){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function k(t,e){return(k=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function S(t){return(S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function O(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function P(t,e){return!e||"object"!==S(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function j(t){return(j=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function M(t,e){return(M=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function E(t){return(E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function C(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function I(t,e){return!e||"object"!==E(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function D(t){return(D=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function z(t,e){return(z=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function T(t){return(T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function A(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function R(t,e){return!e||"object"!==T(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function B(t){return(B=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function W(t,e){return(W=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var L={rect:function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),c(this,f(e).call(this,t))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(e,a),n=e,(r=[{key:"draw",value:function(t){var e=this.get("style");this._draw(t,e)}},{key:"_draw",value:function(t,e){t.save(),e.lineDash&&t.setLineDash(e.lineDash),t.beginPath(),t.fillStyle=e.fill,t.strokeStyle=e.stroke,t.lineWidth=e.lineWidth,e.borderRadius?(u(t,this.getPoints(e),e.borderRadius),t.closePath(),e.stroke&&t.stroke(),e.fill&&t.fill()):(e.fill&&t.fillRect(e.x,e.y,e.width,e.height),e.stroke&&t.strokeRect(e.x,e.y,e.width,e.height)),t.restore()}},{key:"_updatePosition",value:function(t,e){this._cfg.style.x=t,this._cfg.style.y=e}},{key:"_updateSize",value:function(t,e){this._cfg.style.width=t,this._cfg.style.height=e}},{key:"getPoints",value:function(t){var e=t.x,n=t.y,r=t.borderRadius,i=t.width,o=t.height,a=a=[{x:e+r,y:n},{x:e+i,y:n},{x:e+i,y:n+o},{x:e,y:n+o},{x:e,y:n}];return a}},{key:"getDefaultCfg",value:function(){return{x:0,y:0}}},{key:"getShapeStyle",value:function(){var t=this._cfg,e=t.size;o.a.isArray(t.size)?this._updateSize(e[0],e[1]):this._updateSize(e,e),this._updatePosition(t.x-t.style.width/2,t.y-t.style.height/2);var n={};return o.a.extend(n,this.getDefaultStyle(),t.style),n}},{key:"getDefaultStyle",value:function(){return{z:0,width:0,height:0,color:"#000",stroke:!1,lineWidth:1,lineDash:null}}}])&&s(n.prototype,r),i&&s(n,i),e}(),line:function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),g(this,v(e).call(this,t))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&d(t,e)}(e,a),n=e,(r=[{key:"draw",value:function(t){this._draw(t)}},{key:"_draw",value:function(n){if(!n)throw new Error("illegal context");var r=this.get("style"),i=this.get("points");n.save(),r.lineDash&&n.setLineDash(r.lineDash),n.strokeStyle=r.stroke,n.lineWidth=r.lineWidth,n.lineJoin=r.lineJoin,n.lineCap=r.lineCap,n.beginPath(),o.a.each(i,function(t,e){0===e?n.moveTo(t.x,t.y):e===i.length-1&&r.arrow?h(n,[i[i.length-2],t],r):n.lineTo(t.x,t.y)}),n.stroke(),n.restore()}},{key:"updatePoints",value:function(t){this.set("points",t)}},{key:"getDefaultStyle",value:function(){return{stroke:"#000",lineWidth:2,lineJoin:"miter",lineCap:"butt"}}},{key:"getShapeStyle",value:function(){return o.a.mix({},this.getDefaultStyle(),this._cfg.style)}},{key:"getDefaultCfg",value:function(){return{points:[]}}}])&&p(n.prototype,r),i&&p(n,i),e}(),polyline:function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),_(this,w(e).call(this,t))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&k(t,e)}(e,a),n=e,(r=[{key:"draw",value:function(t){this._draw(t)}},{key:"_draw",value:function(t){if(!t)throw new Error("illegal context");var e,n=this.get("style"),r=this.get("points");t.save(),t.strokeStyle=n.stroke,t.lineWidth=n.lineWidth,t.lineJoin=n.lineJoin,t.lineCap=n.lineCap,t.beginPath(),n.arrow&&(e=r.slice(-2),r=r.slice(0,-1)),b(t,r),t.stroke(),t.restore(),n.arrow&&h(t,e,{lineWidth:2,color:n.stroke})}},{key:"updatePoints",value:function(t){this.set("points",t)}},{key:"getDefaultStyle",value:function(){return{stroke:"#000",lineWidth:2,lineJoin:"miter",lineCap:"butt"}}},{key:"getShapeStyle",value:function(){var t=o.a.mix({},this.getDefaultStyle(),this._cfg.style);return t.arrow=this.get("arrow"),t}},{key:"getDefaultCfg",value:function(){return{x:0,y:0,points:[],anchors:[]}}}])&&x(n.prototype,r),i&&x(n,i),e}(),circle:function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),P(this,j(e).call(this,t))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&M(t,e)}(e,a),n=e,(r=[{key:"draw",value:function(t){this._draw(t)}},{key:"_draw",value:function(t){if(!t)throw new Error("illegal context");var e=this.get("style");t.save(),t.lineWidth=e.lineWidth,t.strokeStyle=e.stroke,t.fillStyle=e.fill,t.beginPath(),t.arc(e.x,e.y,e.r,0,2*Math.PI),e.fill&&t.fill(),e.stroke&&t.stroke(),t.restore()}},{key:"changePosition",value:function(t,e){this._cfg.style.x=t,this._cfg.style.y=e}},{key:"changeSize",value:function(t){this._cfg.style.r=t}},{key:"getShapeStyle",value:function(){var t=this._cfg,e=t.size;o.a.isArray(t.size)?this.changeSize(e[0],e[1]):this.changeSize(e,e),this.changePosition(t.x,t.y);var n={};return o.a.extend(n,this.getDefaultStyle(),t.style),n}},{key:"getDefaultStyle",value:function(){return{z:0,width:0,height:0,color:"#000",stroke:!1,lineWidth:1}}},{key:"getDefaultCfg",value:function(){return{x:0,y:0}}}])&&O(n.prototype,r),i&&O(n,i),e}(),text:function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),I(this,D(e).call(this,t))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&z(t,e)}(e,a),n=e,(r=[{key:"draw",value:function(t){this._draw(t,this._cfg)}},{key:"_draw",value:function(t,e){if(!t)throw new Error("illegal context");var n=this.get("style");t.save(),t.textBaseline=n.baseline,t.fillStyle=n.color,t.textAlign=n.align,t.font=n.weight+" "+n.size+" "+n.family,t.shadowBlur=n.shadowBlur,t.shadowColor=n.shadowColor,t.shadowOffsetX=n.shadowOffsetX,t.shadowOffsetY=n.shadowOffsetY,n.stroke?t.strokeText(e.content,e.x,e.y):t.fillText(e.content,e.x,e.y),t.restore()}},{key:"getDefaultCfg",value:function(){return{x:0,y:0,content:""}}},{key:"getShapeStyle",value:function(){var t=o.a.mix({},this.getDefaultStyle(),this.get("style"));return this._cfg.size&&(t.size=this._cfg.size+"px"),t}},{key:"getDefaultStyle",value:function(){return{baseline:"middle",color:"#000",size:"11px",weight:"normal",family:"黑体",align:"center",shadowBlur:0,shadowColor:"#000",shadowOffsetX:0,shadowOffsetY:0,stroke:!1}}}])&&C(n.prototype,r),i&&C(n,i),e}(),diamond:function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),R(this,B(e).call(this,t))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&W(t,e)}(e,a),n=e,(r=[{key:"draw",value:function(t){var e=this.getPoints(this.get("style"));this._draw(t,e)}},{key:"_draw",value:function(t,e){if(!t)throw new Error("illegal context");var n=this.get("style");t.save(),t.fillStyle=n.fill,t.lineWidth=n.lineWidth,t.strokeStyle=n.stroke,t.beginPath(),n.borderRadius?u(t,e,n.borderRadius):b(t,e,n),t.closePath(),n.fill&&t.fill(),n.stroke&&t.stroke(),t.restore()}},{key:"changePosition",value:function(t,e){this._cfg.style.x=t,this._cfg.style.y=e}},{key:"changeSize",value:function(t,e){this._cfg.style.width=t,this._cfg.style.height=e}},{key:"getPoints",value:function(t){var e=Math.PI;return[{x:t.x-t.width/2+Math.cos(.25*e)*t.borderRadius,y:t.y-Math.cos(.25*e)*t.borderRadius},{x:t.x,y:t.y-t.height/2},{x:t.x+t.width/2,y:t.y},{x:t.x,y:t.y+t.height/2},{x:t.x-t.width/2,y:t.y}]}},{key:"getShapeStyle",value:function(){var t=this._cfg,e=t.size;o.a.isArray(t.size)?this.changeSize(e[0],e[1]):this.changeSize(e,e),this.changePosition(t.x,t.y);var n={};return o.a.extend(n,this.getDefaultStyle(),t.style),n}},{key:"getDefaultStyle",value:function(){return{z:0,width:0,height:0,color:"#000",stroke:!1,lineWidth:1}}},{key:"getDefaultCfg",value:function(){return{x:0,y:0}}}])&&A(n.prototype,r),i&&A(n,i),e}()},X=function(t){var e=L[t.type];if(!e)throw new Error("shape ".concat(t.type," is not exsit"));return new e(t)};function Y(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var F=function(){function n(t){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),this.children=[],this._cfg={},t&&t.type){var e=X(t);this._cfg.shape=e,t.layer&&t.layer.addLayer(this)}}var t,e,r;return t=n,(e=[{key:"_init",value:function(){}},{key:"draw",value:function(t){t.save(),this._drawLayer(t),this._draw(t),t.restore()}},{key:"_drawLayer",value:function(t){var e=this.get("shape");e&&e.draw(t)}},{key:"_draw",value:function(e){o.a.each(this.children,function(t){!t.get("hidden")&&t.draw(e)})}},{key:"add",value:function(t){this.children.push(t)}},{key:"addChild",value:function(){}},{key:"removeChild",value:function(){}},{key:"addLayer",value:function(t){return(t.parent=this).add(t),t}},{key:"addShape",value:function(t){var e=X(t);return(e.parent=this).add(e),e}},{key:"set",value:function(t,e){o.a.isPlainObject(t)?this._cfg=o.a.mix({},this._cfg,t):this._cfg[t]=e}},{key:"get",value:function(t){return this._cfg[t]}}])&&Y(t.prototype,e),r&&Y(t,r),n}();e.a=F},function(t,e){function i(t,e){for(var n in e)e.hasOwnProperty(n)&&"constructor"!==n&&void 0!==e[n]&&(t[n]=e[n])}t.exports=function(t,e,n,r){return e&&i(t,e),n&&i(t,n),r&&i(t,r),t}},function(t,e,n){"use strict";var m=n(0);function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=["click","mousedown","mouseup","dblclick","contextmenu","mouseenter","mouseout","mouseover","mousemove","mouseleave","dragstart","dragend","drag","dragenter","dragleave","drop"],a=function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.graph=t,this._initEvents()}var t,n,r;return t=e,(n=[{key:"_initEvents",value:function(){var e=this,n=this.graph.get("canvas");m.a.each(o,function(t){n.on(t,e._canvasEvent())})}},{key:"_canvasEvent",value:function(){var e=this;return function(t){e._handleEvents({type:t.type,clientX:t.clientX,clientY:t.clientY,origin:t})}}},{key:"_handleEvents",value:function(i){var t=i.type,e=this.graph,n=e.get("nodes"),r=e.get("edges"),o=(e.get("eventItemMap"),e.get("activeEdge")),a=e.get("targetMap").drag,u=e.getPointByClient(i.clientX,i.clientY);i.clientX=u.x,i.clientY=u.y;var s=[];m.a.each(n.concat(r),function(t){var e=t.get("children"),n=e?m.a.find(e,function(t){return t.isPointIn(u)&&t.get("event")}):null,r=!1;if(n?(r=!0,t=n):r=t.isPointIn(u),r&&o!==t&&a!==t&&t.get("event"))return i.target=t,s.push(t),!1}),"mousemove"===t?this._handleEventMousemove(i,s):"mousedown"===t?this._handleEventMousedown(i,s):"mouseup"===t&&this._handleEventMouseup(i,s)}},{key:"_handleEventMousedown",value:function(t,e){var n=this.graph,r=n.get("targetMap"),i=e[0],o=r.focus;o&&o!=i&&(o.setState("focus",!1),r.focus=null),i&&((r.mousedown=i).setState("focus",!0),r.focus=i,n.set("downPoint",{x:t.clientX,y:t.clientY}),i.emit("mousedown",t)),n.emit("mousedown",t)}},{key:"_handleEventMouseup",value:function(t,e){var n=this.graph.get("targetMap"),r=e[0],i=!1;n.mousedown&&(n.mousedown=null),n.drag&&(i=!0,n.drag.emit("drop",t),n.drag=null),r&&!i&&r.emit("mouseup",t)}},{key:"_handleEventMousemove",value:function(t,e){var n=this.graph,r=n.get("targetMap"),i=e[0],o=!1,a=r.mousedown,u=r.mouseenter,s=r.dragenter,c=r.drag;if(a&&!c){var f=n.get("downPoint");this._isDragStart([f,{x:t.clientX,y:t.clientY}])&&(a.setState("focus",!0),(r.drag=a).emit("dragstart",t))}else c?(o=!0,c.emit("drag",t)):u&&(!u.isPointIn({x:t.clientX,y:t.clientY})||i&&u!==i)&&(r.mouseenter=null,u.setState("hover",!1),u.emit("mouseleave",t),u=null);s&&!s.isPointIn({x:t.clientX,y:t.clientY})&&(r.dragenter=null,s.setState("hover",!1),s.emit("dragleave",t)),i&&(o?(s||c===i||n.get("activeEdge")===i||((r.dragenter=i).setState("hover",!0),i.emit("dragenter",t)),i.emit("mousemove",t)):r.mouseenter!==i&&(u&&(u.setState("focus",!1),u.emit("mouseleave",t)),i.setState("hover",!0),(r.mouseenter=i).emit("mouseenter",t)))}},{key:"_isDragStart",value:function(t){return 5<Math.abs(t[0].x-t[1].x)||5<Math.abs(t[0].y-t[1].y)}},{key:"getDefaultOption",value:function(){return{cancelBubble:!0}}}])&&i(t.prototype,n),r&&i(t,r),e}(),u=Array.prototype.slice;var r=function(){};m.a.augment(r,{on:function(t,e,n){var r=this;if(!m.a.isFunction(e))throw new TypeError("listener should be a function");return r._cfg._events||(r._cfg._events={}),r._cfg._events[t]||(r._cfg._events[t]=[]),r._cfg._events[t].push({callback:e,one:n}),this},one:function(t,e){return this.on(t,e,!0),this},emit:function(t){if(!this.get("destroyed")&&this._cfg._events&&!m.a.isEmpty(this._cfg._events)){var e=this._cfg._events[t];if(!m.a.isEmpty(e))for(var n=arguments,r=u.call(n,1),i=e.length,o=0;o<i;)e[o]&&(e[o].callback.apply(this,r),e[o]&&e[o].one?(e.splice(o,1),i--):o++)}},trigger:function(){this.emit.apply(this,arguments)},off:function(t,e){var n=this._cfg._events;if(n&&!m.a.isEmpty(n)){if(0===arguments.length)return this._cfg._events={},this;if(n[t]){var r=function(t,e){for(var n=t.length;n--;)if(t[n].callback===e)return n;return-1}(n[t],e);0<=r&&n[t].splice(r,1),0===n[t].length&&delete n[t]}}},removeEvent:function(t){return void 0===t?this._cfg._events={}:delete this._cfg._events[t],this},_getEvents:function(){return this._cfg._events||{}}});var s=r,c=n(2);function f(t){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function h(t,e){return!e||"object"!==f(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function y(t){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function p(t,e){return(p=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var g=function(t){function n(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n);return(e=h(this,y(n).call(this)))._cfg=m.a.deepMix({width:1e3,height:500,ratio:1,matrix:[1,0,0,0,1,0,0,0,1]},t),e.init(),e}var e,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&p(t,e)}(n,c["a"]),e=n,(r=[{key:"init",value:function(){this._init()}},{key:"_init",value:function(){var t=this._cfg,e=this.get("ratio");if(!m.a.isString(t.containerId))throw new Error("containerId must be string");var n=document.getElementById(t.containerId);if(!n)return console.error("canvas is not exsit, please check the containerId"),!1;var r=n.getContext("2d");this.set("canvas",n),this.set("context",r),this.changeSize(t.width,t.height);var i=this.get("width")*e,o=this.get("height")*e;this.addLayer(new c.a({type:"rect",x:i/2,y:o/2,size:[i,o],style:{fill:"#FFF"}}))}},{key:"changeSize",value:function(t,e){this._cfg.width=t,this._cfg.height=e,this._changeSize(t,e)}},{key:"_changeSize",value:function(t,e){var n=this.get("canvas"),r=this.get("ratio");n.width=this._cfg.width*r,n.height=this._cfg.height*r,n.style.width=this._cfg.width+"px",n.style.height=this._cfg.height+"px"}},{key:"draw",value:function(){var t=this.get("context");if(!t)throw new Error("context is not available");this.clean(this.get("width"),this.get("height"));var e=this.get("ratio");t.save(),t.scale(e,e),this._draw(t),t.restore()}},{key:"clean",value:function(t,e){this.get("context").clearRect(0,0,t,e)}},{key:"clear",value:function(){this.children=[],this.clean()}},{key:"destory",value:function(){this.clear()}},{key:"scale",value:function(t){var e=this.get("matrix");e[0]=t,e[4]=t,this.set("ratio",t)}},{key:"getBox",value:function(){var t=this.get("canvas").getBoundingClientRect();return{l:t.left,t:t.top,r:t.right,b:t.bottom,width:t.width,height:t.height}}},{key:"getMatrix",value:function(){return this.get("matrix")}},{key:"on",value:function(t,e){this.get("canvas").addEventListener(t,e)}}])&&l(e.prototype,r),i&&l(e,i),n}(),v={rect:function(t,e){var n=t.size,r=0,i=0,o=t.x,a=t.y;i=m.a.isArray(n)?(r=n[0],n[1]):r=n;var u=r/2,s=i/2;return{x:o,y:a,t:a-s,l:o-u,b:a+s,r:o+u,width:r,height:i}},circle:function(t){var e=t.size,n=2*e,r=2*e,i=t.x,o=t.y,a=n/2,u=r/2;return{x:i,y:o,t:o-u,l:i-a,b:o+u,r:i+a,width:n,height:r}},diamond:function(t){return this.rect(t)}},d=function(t){return t.type||console.error("shape.type属性不存在"),v[t.type]?v[t.type](t.outlineCfg||t):(console.error("没有找到对应的图形"),{})},b=n(1),k=n.n(b),x={box:function(t,e,n,r,i){var o=i/2,a=Math.min(t,n),u=Math.max(t,n);return{minX:a-o,minY:Math.min(e,r)-o,maxX:u+o,maxY:Math.max(e,r)+o}},pointDistance:function(t,e,n,r,i,o){var a=[n-t,r-e];if(k.a.exactEquals(a,[0,0]))return NaN;var u=[-a[1],a[0]];k.a.normalize(u,u);var s=[i-t,o-e];return Math.abs(k.a.dot(s,u))}},_=function(t,e,n,r){var i=1-r;return i*(i*t+2*r*e)+r*r*n},w=function(t,e,n,r,i,o,a,u,s){var c,f,l,h,y,p,g,v=.005,d=1/0,b=[a,u];for(y=0;y<1;y+=.05)l=[_(t,n,i,y),_(e,r,o,y)],(f=k.a.squaredDistance(b,l))<d&&(c=y,d=f);for(d=1/0,g=0;g<32&&!(v<1e-4);g++){var m=c-v,x=c+v;l=[_(t,n,i,m),_(e,r,o,m)],f=k.a.squaredDistance(b,l),0<=m&&f<d?(c=m,d=f):(h=[_(t,n,i,x),_(e,r,o,x)],p=k.a.squaredDistance(b,h),x<=1&&p<d?(c=x,d=p):v*=.5)}return s&&(s.x=_(t,n,i,c),s.y=_(e,r,o,c)),Math.sqrt(d)},S=function(t,e,n,r,i){var o=1-i;return o*o*(o*r+3*i*n)+i*i*(i*t+3*o*e)},O=function(t,e,n,r,i,o,a,u,s,c,f){var l,h,y,p,g,v,d,b,m=.005,x=1/0,_=[s,c];for(h=0;h<1;h+=.05)y=[S(t,n,i,a,h),S(e,r,o,u,h)],(p=k.a.squaredDistance(_,y))<x&&(l=h,x=p);x=1/0;for(var w=0;w<32&&!(m<1e-4);w++)b=l+m,y=[S(t,n,i,a,d=l-m),S(e,r,o,u,d)],p=k.a.squaredDistance(_,y),0<=d&&p<x?(l=d,x=p):(v=[S(t,n,i,a,b),S(e,r,o,u,b)],g=k.a.squaredDistance(_,v),b<=1&&g<x?(l=b,x=g):m*=.5);return f&&(f.x=S(t,n,i,a,l),f.y=S(e,r,o,u,l)),Math.sqrt(x)},P=function(t,e,n,r){var i,o;return r?t<e?(i=e-t,o=2*Math.PI-n+t):n<t&&(i=2*Math.PI-t+e,o=t-n):(i=t-e,o=n-t),o<i?n:e},j=function(t,e,n,r,i,o,a,u,s){var c,f,l,h,y,p=[a,u],g=[t,e],v=k.a.subtract([],p,g),d=k.a.angleTo([1,0],v);c=d,h=o,y=0,(l=i)-(f=r)>=2*Math.PI&&(y=2*Math.PI),f=m.a.mod(f,2*Math.PI),l=m.a.mod(l,2*Math.PI)+y,c=m.a.mod(c,2*Math.PI),d=h?l<=f?l<c&&c<f?c:P(c,l,f,!0):c<f||l<c?c:P(c,f,l):f<=l?f<c&&c<l?c:P(c,f,l,!0):f<c||c<l?c:P(c,l,f);var b=[n*Math.cos(d)+t,n*Math.sin(d)+e];return s&&(s.x=b[0],s.y=b[1]),k.a.distance(b,p)},M={line:function(t,e,n,r,i,o,a){var u=x.box(t,e,n,r,i);if(!this.box(u.minX,u.maxX,u.minY,u.maxY,o,a))return!1;var s=x.pointDistance(t,e,n,r,o,a);return!isNaN(s)&&s<=i/2},polyline:function(t,e,n,r){var i=t.length-1;if(i<1)return!1;for(var o=0;o<i;o++){var a=t[o].x,u=t[o].y,s=t[o+1].x,c=t[o+1].y;if(this.line(a,u,s,c,e,n,r))return!0}return!1},cubicline:function(t,e,n,r,i,o,a,u,s,c,f){return O(t,e,n,r,i,o,a,u,c,f)<=s/2},quadraticline:function(t,e,n,r,i,o,a,u,s){return w(t,e,n,r,i,o,u,s)<=a/2},arcline:function(t,e,n,r,i,o,a,u,s){return j(t,e,n,r,i,o,u,s)<=a/2},rect:function(t,e,n,r,i,o){return t<=i&&i<=t+n&&e<=o&&o<=e+r},circle:function(t,e,n,r,i){return Math.pow(r-t,2)+Math.pow(i-e,2)<=Math.pow(n,2)},box:function(t,e,n,r,i,o){return t<=i&&i<=e&&n<=o&&o<=r}},E={box:function(t,e){var n=t.get("box");return M.box(n.l,n.r,n.t,n.b,e.x,e.y)},rect:function(t,e){var n=t.get("box");return M.rect(n.l,n.t,n.width,n.height,e.x,e.y)},circle:function(t,e){var n=t.get("box");return M.circle(n.x,n.y,n.width/2,e.x,e.y)},polyline:function(t,e){var n=t.get("shape");return M.polyline(n.points,n.style.lineWidth+6,e.x,e.y)}},C=function(t,e){var n=t.get("shape").type;return!!n&&(E[n]||E.box).apply(this,[t,e])};function I(t){return(I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var D={linear:function(t,e,n,r){return t*(n/r)+e}},z=function(f){var l=this,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},e=t.type||"linear",h=t.duration||1e3,y=D[e],p=this.getShape(),n=function(t){var e=f[t],n=p.get("style"),r=n[t];if(!r&&0!==r)return{v:!1};var i=0,o=h,a=e-r,u=r,s={},c=setInterval(function(){i<o?(u=y(i+=1e3/60,r,a,o),s[t]=u,n[t]=u,l.get("graph").paint()):(clearInterval(c),s[t]=e,l.update(s))},1e3/60)};for(var r in f){var i=n(r);if("object"===I(i))return i.v}};function T(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var A=function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.init(t)}var t,n,r;return t=e,(n=[{key:"init",value:function(t){this._cfg=m.a.deepMix(this.getDefaultCfg(),t),this._init()}},{key:"_init",value:function(){var t=this.get("graph"),e=m.a.mix(this.getDefaultShapeCfg(),m.a.clone(this.getShapeCfg()));console.log(e),t.addShape(e),this.getBox()}},{key:"on",value:function(t,e,n){var r=this.get("graph"),i=r.get("eventMap"),o=r.get("eventItemMap"),a={item:this,callback:e,option:n,children:[]};i[t]?i[t].push(a):i[t]=[a];var u=this.get("id");o[u]||(o[u]={}),o[u][t]=a}},{key:"emit",value:function(t){var e=this.get("graph").get("eventItemMap")[this.get("id")];if(!e)return!1;var n=e[t];if(!n)return!1;var r=n.callback,i=[].slice.call(arguments,1);r.apply(this,i)}},{key:"update",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=this._cfg.x,n=this._cfg.y,r=this.getShapeCfg();m.a.mix(r,t),this._isOnlyMove(t)?this.updatePosition(r):(e===r.x&&n===r.y||this.updatePosition(r),(t.width||t.height||t.r||t.size)&&this.updateSize(r),this.updateShape()),this.get("graph").autoPaint()}},{key:"updatePosition",value:function(t){var e=this.get("graph");this._cfg.x=t.x,this._cfg.y=t.y;var n=e.get("shapeMap")[this.get("id")];(n.get("shape")?n.get("shape"):n).update({x:t.x,y:t.y})}},{key:"updateSize",value:function(t){t.width||t.height?m.a.isArray.shape.size?(t.size[0]=t.width,t.size[1]=t.height):t.width?t.size=t.width:t.height&&(t.size=t.height):t.r&&(t.size=t.r)}},{key:"updateShape",value:function(){var t=this.get("shape");this.getShape().update(t),this.get("graph").autoPaint()}},{key:"animate",value:function(t,e){z.call(this,t,e)}},{key:"getShapeCfg",value:function(){return this._getShapeCfg()}},{key:"_getShapeCfg",value:function(){var t=this.get("shape");return m.a.mix(t,{x:this._cfg.x,y:this._cfg.y}),t}},{key:"getBox",value:function(){var t=this.get("shape"),e=this.get("graph").get("ratio"),n=d(t,e);return this.set("box",n),n}},{key:"_isOnlyMove",value:function(t){if(!t)return!1;var e=!m.a.isNil(t.x),n=!m.a.isNil(t.y),r=Object.keys(t);return 1===r.length&&(e||n)||2===r.length&&e&&n}},{key:"isPointIn",value:function(t){return C(this,t)}},{key:"set",value:function(t,e){m.a.isPlainObject(t)?this._cfg=m.a.mix({},this._cfg,t):this._cfg[t]=e}},{key:"setState",value:function(t,e){var n=this.get("state");n[t]=e;var r=this.get("stateShapeMap");if(r){var i=m.a.deepMix(this.getDefaultShapeCfg(),r.default);if(m.a.each(n,function(t,e){t&&m.a.deepMix(i,r[e])}),i){var o=this.get("shape");m.a.deepMix(o,i),this.updateShape()}}this.emit("stateChange",t,e,n)}},{key:"get",value:function(t){return this._cfg[t]}},{key:"show",value:function(){var t=this.get("graph");this.set("hidden",!1),this.getShape().update({hidden:!1}),t.paint()}},{key:"hide",value:function(){var t=this.get("graph");this.set("hidden",!0),this.getShape().update({hidden:!0}),t.paint()}},{key:"getShape",value:function(){return this.get("graph").get("shapeMap")[this.get("id")]}},{key:"getDefaultCfg",value:function(){return m.a.mix({state:{},box:{},parent:"",shape:{},alwaysShow:!0},this._getDefaultCfg())}},{key:"_getDefaultCfg",value:function(){return{}}},{key:"getDefaultShapeCfg",value:function(){var t=this.get("graph"),e=this.get("parent"),n=t.get("shapeMap")[e];return{id:this.get("id"),parent:n}}}])&&T(t.prototype,n),r&&T(t,r),e}();function R(t){return(R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function B(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function W(t,e){return!e||"object"!==R(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function L(t,e,n){return(L="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=X(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function X(t){return(X=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Y(t,e){return(Y=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var F=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=t[0],n=t[1];return e===n&&0===e?"corner":0===e?"left":1===e?"right":0===n?"top":1===n&&"bottom"},q=function(t,e){var n=t.x,r=t.y;return"left"===e?n-=30:"top"===e?r-=30:"right"===e?n+=30:"bottom"===e&&(r+=30),{x:n,y:r}};function N(t){return(N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function H(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function J(t,e){return!e||"object"!==N(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function G(t,e,n){return(G="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=U(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function U(t){return(U=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function $(t,e){return($=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function V(t){return(V="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Z(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function K(t,e){return!e||"object"!==V(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function Q(t,e,n){return(Q="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=tt(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function tt(t){return(tt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function et(t,e){return(et=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var nt={base:A,node:function(t){function s(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),W(this,X(s).call(this,t))}var e,n,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Y(t,e)}(s,A),e=s,(n=[{key:"_init",value:function(){var t=this.get("graph"),e=t.get("nodeLayer"),n=this.getShapeCfg(),r=e.addLayer(new c.a(n));r.parent=e,t.get("shapeMap")[this.get("id")]=r,this.getBox(),this.addLabel()}},{key:"addEdge",value:function(t,e){this.get("".concat(t,"Edges")).push(e)}},{key:"removeEdge",value:function(t,e){var n=this.get("".concat(t,"Edges")),r=n.indexOf(e);n.splice(r,1)}},{key:"addLabel",value:function(){var t=this.get("graph"),e=this.get("label"),n=t.get("shapeMap"),r=m.a.mix({offsetX:0,offsetY:0},this.get("labelCfg"));r.type="text",r.content=e,r.x=this._cfg.x+r.offsetX,r.y=this._cfg.y+r.offsetY,r.parent=n[this.get("id")],this.set("labelCfg",r);var i=t.addShape(r);this.set("labelId",i)}},{key:"setState",value:function(t,e){L(X(s.prototype),"setState",this).call(this,t,e),this.handleStateChange(t)}},{key:"handleStateChange",value:function(t){var e=this.get("graph");e.get("shapeMap"),this.get("state");e.autoPaint()}},{key:"updatePosition",value:function(t){L(X(s.prototype),"updatePosition",this).call(this,t);var e=this.get("graph"),n=e.get("shapeMap");this.getBox();var r=this.get("outEdges");m.a.each(r,function(t){e.findById(t).updatePath()});var i=this.get("inEdges");m.a.each(i,function(t){e.findById(t).updatePath()});var o=this.get("labelId");if(o){var a=n[o];if(a){var u=this.get("labelCfg");a.update({x:t.x+u.offsetX,y:t.y+u.offsetY})}}}},{key:"getAnchorPoint",value:function(t){var e=this.get("box");return{x:e.l+e.width*t[0],y:e.t+e.height*t[1],m:t}}},{key:"_getDefaultCfg",value:function(){return{x:0,y:0,state:{},box:{},parent:"",children:[],anchorMatrix:[],outEdges:[],inEdges:[],label:"",labelCfg:{},anchors:{}}}}])&&B(e.prototype,n),r&&B(e,r),s}(),edge:function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),J(this,U(e).call(this,t))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&$(t,e)}(e,A),n=e,(r=[{key:"_init",value:function(){G(U(e.prototype),"_init",this).call(this)}},{key:"_getShapeCfg",value:function(){var t=this.get("shape"),e=this._getPoints();return t.arrow=this.get("arrow"),t.points=e,t}},{key:"_getPoints",value:function(){var t=this.get("graph"),e=this.get("shape"),n=t.findById(this.get("source")),r=this.get("startAnchor"),i=n.getAnchorPoint(r);this.set("startPoint",i);var o=t.findById(this.get("target")),a=o&&this.get("endAnchor"),u=o?o.getAnchorPoint(a):e.endPoint;return this.set("endPoint",u),function(t,e,n,r,i){var o=n.x,a=n.y,u=r.x,s=r.y,c=[{x:o,y:a}],f=F(t),l=F(e),h=q(n,f);o=h.x,a=h.y;var y=q(r,l);u=y.x,s=y.y;var p,g,v,d,b,m,x,_,w,k,S=(g=y,v=(p=h).x,d=p.y,b=g.x,m=g.y,v<b&&m<d?1:b<v&&m<d?2:b<v&&d<m?3:v<b&&d<m?4:void 0);if(c.push(h),!l){var O=Math.abs(o-u),P=Math.abs(a-s);"top"===f||"bottom"===f?1===S?P<O?(c.push({x:o,y:a-P/2}),c.push({x:u,y:a-P/2})):c.push({x:o,y:s}):2===S?P<O?(c.push({x:o,y:a-P/2}),c.push({x:u,y:a-P/2})):c.push({x:o,y:s}):3===S?P<O?(c.push({x:o,y:a+P/2}),c.push({x:u,y:a+P/2})):c.push({x:o,y:s}):4===S&&(P<O?(c.push({x:o,y:a+P/2}),c.push({x:u,y:a+P/2})):c.push({x:o,y:s})):"left"!==f&&"right"!==f||(1===S?O<P?(c.push({x:o+O/2,y:a}),c.push({x:o+O/2,y:s})):c.push({x:u,y:a}):2===S?O<P?(c.push({x:o-O/2,y:a}),c.push({x:o-O/2,y:s})):c.push({x:u,y:a}):3===S?O<P?(c.push({x:o-O/2,y:a}),c.push({x:o-O/2,y:s})):c.push({x:u,y:a}):4===S&&(O<P?(c.push({x:o+O/2,y:a}),c.push({x:o+O/2,y:s})):c.push({x:u,y:a})))}return"left"===f?1===S?"left"===l?c.push({x:o,y:s}):"top"===l?c.push({x:o,y:s}):"right"===l?(c.push({x:o,y:s+(a-s)/2}),c.push({x:u,y:s+(a-s)/2})):"bottom"===l&&c.push({x:o,y:s}):2===S?"left"===l?c.push({x:u,y:a}):"top"===l?c.push({x:o,y:s}):"right"===l?(c.push({x:u+(o-u)/2,y:a}),c.push({x:u+(o-u)/2,y:s})):"bottom"===l&&c.push({x:u,y:a}):3===S?"left"===l?c.push({x:u,y:a}):"top"===l?c.push({x:u,y:a}):"right"===l?(c.push({x:u+(o-u)/2,y:a}),c.push({x:u+(o-u)/2,y:s})):"bottom"===l&&c.push({x:o,y:s}):4===S&&("left"===l?c.push({x:o,y:s}):"top"===l?c.push({x:o,y:s}):"right"===l?(c.push({x:o,y:s+(a-s)/2}),c.push({x:u,y:s+(a-s)/2})):"bottom"===l&&c.push({x:o,y:s})):"top"===f?1===S?"left"===l?c.push({x:o,y:s}):"top"===l?c.push({x:o,y:s}):"right"===l?c.push({x:u,y:a}):"bottom"===l&&(c.push({x:o,y:s+(a-s)/2}),c.push({x:u,y:s+(a-s)/2})):2===S?"left"===l?c.push({x:u,y:a}):"top"===l?c.push({x:o,y:s}):"right"===l?c.push({x:o,y:s}):"bottom"===l&&(c.push({x:o,y:s+(a-s)/2}),c.push({x:u,y:s+(a-s)/2})):3===S?"left"===l?c.push({x:u,y:a}):"top"===l?c.push({x:u,y:a}):"right"===l?c.push({x:u,y:a}):"bottom"===l&&(c.push({x:u+(o-u)/2,y:a}),c.push({x:u+(o-u)/2,y:s})):4===S&&("left"===l?c.push({x:u,y:a}):"top"===l?c.push({x:u,y:a}):"right"===l?c.push({x:u,y:a}):"bottom"===l&&(c.push({x:u+(o-u)/2,y:a}),c.push({x:u+(o-u)/2,y:s}))):"right"===f?1===S?"left"===l?(c.push({x:u+(o-u)/2,y:a}),c.push({x:u+(o-u)/2,y:s})):"top"===l?c.push({x:o,y:s}):"right"===l?c.push({x:u,y:a}):"bottom"===l&&c.push({x:u,y:a}):2===S?"left"===l?(c.push({x:o,y:s+(a-s)/2}),c.push({x:u,y:s+(a-s)/2})):"top"===l?c.push({x:o,y:s}):"right"===l?c.push({x:o,y:s}):"bottom"===l&&c.push({x:o,y:s}):3===S?"left"===l?(c.push({x:o,y:s+(a-s)/2}),c.push({x:u,y:s+(a-s)/2})):"top"===l?c.push({x:o,y:s}):"right"===l?c.push({x:o,y:s}):"bottom"===l&&c.push({x:o,y:s}):4===S&&("left"===l?(c.push({x:u+(o-u)/2,y:a}),c.push({x:u+(o-u)/2,y:s})):"top"===l?c.push({x:u,y:a}):"right"===l?c.push({x:u,y:a}):"bottom"===l&&c.push({x:o,y:s})):"bottom"===f&&(1===S?"left"===l?c.push({x:u,y:a}):"top"===l?(c.push({x:u+(o-u)/2,y:a}),c.push({x:u+(o-u)/2,y:s})):"right"===l?c.push({x:u,y:a}):"bottom"===l&&c.push({x:u,y:a}):2===S?"left"===l?c.push({x:u,y:a}):"top"===l?(c.push({x:u+(o-u)/2,y:a}),c.push({x:u+(o-u)/2,y:s})):"right"===l?c.push({x:u,y:a}):"bottom"===l&&c.push({x:u,y:a}):3===S?"left"===l?c.push({x:u,y:a}):"top"===l?(c.push({x:o,y:s+(a-s)/2}),c.push({x:u,y:s+(a-s)/2})):"right"===l?c.push({x:o,y:s}):"bottom"===l&&c.push({x:o,y:s}):4===S&&("left"===l?c.push({x:o,y:s}):"top"===l?(c.push({x:o,y:s+(a-s)/2}),c.push({x:u,y:s+(a-s)/2})):"right"===l?c.push({x:u,y:a}):"bottom"===l&&c.push({x:o,y:s}))),y&&c.push(y),i&&c.push((_=l,w=(x=r).x,k=x.y,"left"===_?w-=10:"top"===_?k-=10:"right"===_?w+=10:"bottom"===_&&(k+=10),{x:w,y:k})),c.push(r),c}(r,a,i,u,this.get("arrow"))}},{key:"getPointOnDir",value:function(t){var e="",n=this.get("startPoint"),r=this.get("endPoint"),i=t.x,o=t.y,a=this.get("shape").style.lineWidth;return Math.abs(i-n.x)<=a||Math.abs(i-r.x)<=a?e="V":(Math.abs(o-n.y)<=a||Math.abs(o-r.y)<=a)&&(e="H"),e}},{key:"getPathPart",value:function(t){for(var e,n=this.get("shape").points,r=t.x,i=t.y,o=this.get("shape").style.lineWidth,a=0,u=n.length;a<u;a++){var s=n[a],c=n[a+1];if(!c)break;if(Math.abs(r-s.x)<=o&&Math.abs(r-c.x)<=o||Math.abs(i-s.y)<=o&&Math.abs(i-c.y)<=o){e=[s,c];break}}return e}},{key:"getMidPoint",value:function(t){var e=t[0],n=t[1],r=e.x,i=e.y;return e.x===n.x?i=(e.y-n.y)/2+n.y:e.y===n.y&&(r=(e.x-n.x)/2+n.x),{x:r,y:i}}},{key:"updatePath",value:function(){var t=this.get("shape"),e=this._getPoints();t.points=e,t.arrow=this.get("arrow"),this.updateShape()}},{key:"update",value:function(t){var e=this.getShapeCfg();m.a.mix(e,t),this.updateShape()}},{key:"_getDefaultCfg",value:function(){return{state:{},source:null,target:null,arrow:!1,shape:{startPoint:{},endPoint:{}}}}},{key:"getDefaultShapeCfg",value:function(){var t=this.get("graph");return{id:this.get("id"),parent:t.get("edgeLayer")}}}])&&H(n.prototype,r),i&&H(n,i),e}(),anchor:function(t){function n(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),K(this,tt(n).apply(this,arguments))}var e,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&et(t,e)}(n,A),e=n,(r=[{key:"_init",value:function(){var t=this.get("graph").findById(this.get("parent")),e=this.getPosition();t.get("anchors")[e]=this,Q(tt(n.prototype),"_init",this).call(this)}},{key:"isPointIn",value:function(t){return this.pointDistance({x:this._cfg.x,y:this._cfg.y},t)<225}},{key:"pointDistance",value:function(t,e){return(e.x-t.x)*(e.x-t.x)+(e.y-t.y)*(e.y-t.y)}},{key:"_getShapeCfg",value:function(){Q(tt(n.prototype),"_getShapeCfg",this).call(this);var t=this.get("shape");return t.hidden=this.get("hidden"),t}},{key:"_getDefaultCfg",value:function(){return{state:{},hidden:!1,position:"",m:[],shape:{size:5,type:"circle",style:{lineWidth:2,stroke:"#CCC",fill:"#FFF"}}}}},{key:"getPosition",value:function(){var t,e=this.get("m");return 0===e[0]?t="left":1===e[0]?t="right":0===e[1]?t="top":1===e[1]&&(t="bottom"),t}}])&&Z(e.prototype,r),i&&Z(e,i),n}()};function rt(){for(var t=[],e="0123456789abcdef",n=0;n<16;n++)t[n]=e.substr(Math.floor(16*Math.random()),1);return t[3]="4",t[7]=e.substr(3&t[7]|8,1),t.join("")}var it=function(n){var i={insert:function(t){n.insert(t)},copy:function(){var t=n.get("targetMap").focus;n.set("copiedItem",t)},paste:function(){var t=n.paste(n.get("copiedItem"));return n.set("copiedItem",t),t},delete:function(){var t=n.get("targetMap").focus;n.removeItem(t)},tofront:function(){var t=n.get("targetMap").focus;n.tofront(t)},toback:function(){var t=n.get("targetMap").focus;n.toback(t)},undo:function(){n.undo()},redo:function(){n.redo()},zoomin:function(){n.zoomin()},zoomout:function(){n.zoomout()},fitpage:function(){n.scale(1)},fitpagewidth:function(){var t=n.get("diagramWidth"),e=n.get("width");n.scale(e/t)}};return function(t){var e=Array.from(arguments).slice(1),n=i[t].apply(i,e),r=e.pop();m.a.isFunction(r)&&r(n)}};function ot(t){return(ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function at(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ut(t,e){return!e||"object"!==ot(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function st(t){return(st=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ct(t,e){return(ct=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ft={Graph:function(t){function n(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n);return(e=ut(this,st(n).call(this)))._cfg=m.a.deepMix({containerId:null,width:1e3,height:500,diagramWidth:1e3,diagramHeight:500,ratio:1,maxRatio:1.6,minRatio:.6,nodes:[],edges:[],itemMap:{},shapeMap:{},data:null,eventMap:{},eventItemMap:{},targetMap:{},maxZIndex:0,selectedItem:null,dragingItem:null,hoveringItem:null,nodeLayer:null},t),e._cfg.diagramWidth=e._cfg.width,e._cfg.diagramHeight=e._cfg.height,e._init(),e}var e,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ct(t,e)}(n,s),e=n,(r=[{key:"_init",value:function(){this._initCanvas(),this._initEvent(),this.$trigger=new it(this)}},{key:"_initEvent",value:function(){new a(this)}},{key:"_initCanvas",value:function(){this.set("canvas",new g(this._cfg)),this._initGroups()}},{key:"_initGroups",value:function(){var t=this.get("canvas"),e=new c.a({x:0,y:0,parent:t}),n=new c.a({x:0,y:0,parent:t});t.addLayer(e),t.addLayer(n),this.set("nodeLayer",n),this.set("edgeLayer",e)}},{key:"addItem",value:function(t,e){var n=e.id||rt();(e=m.a.mix({},{id:n},m.a.clone(e))).graph=this,e.zIndex=0,e.type=t,this.emit("beforeAddItem",e);var r=e.parent?this.findById(e.parent):null,i=new nt[t](e);return r&&r.get("children").unshift(i),this.get(t+"s")&&this.get(t+"s").unshift(i),this.get("itemMap")[n]=i,this.autoPaint(),this.emit("afterAddItem",i),i}},{key:"addShape",value:function(t){this.emit("beforeAddShape");var e=t,n=(t.parent||this.get("canvas")).addShape(e),r=this.get("shapeMap"),i=t.id||rt();return r[i]=n,this.autoPaint(),this.emit("afterAddShape"),i}},{key:"removeItem",value:function(t){var e=this.get(t.get("type")+"s"),n=e.indexOf(t),r=this.get("shapeMap")[t.get("id")];r.parent.children.splice(r.parent.children.indexOf(r),1),e.splice(n,1),delete this.get("itemMap")[t.get("id")],this.autoPaint()}},{key:"updateItem",value:function(t,e){this.setAutoPaint(!1),m.a.isString(t)&&(t=this.findById(t)),t.update(e),this.setAutoPaint(!0)}},{key:"clear",value:function(){return this.get("canvas").clear(),this.set({itemMap:{},nodes:[],edges:[]}),this}},{key:"render",value:function(){var t=this,e=this.get("data");this.clear();var n=this.get("autoPaint");this.setAutoPaint(!1),m.a.each(e.nodes,function(){t.addItem("node",node)}),m.a.each(e.edges,function(){t.addItem("edge",node)}),this.paint(),this.setAutoPaint(n)}},{key:"paint",value:function(){this.emit("beforePaint"),this.get("canvas").draw(),this.emit("afterPaint")}},{key:"setAutoPaint",value:function(t){this.set("autoPaint",t),this.autoPaint()}},{key:"autoPaint",value:function(){this.get("autoPaint")&&this.paint()}},{key:"getPointByClient",value:function(t,e){var n=this.get("canvas").getBox();return this.getPointByCanvas(t-n.l,e-n.t)}},{key:"getPointByCanvas",value:function(t,e){return function(t,e){var n,r,i,o,a,u,s,c,f,l,h,y,p,g,v,d,b,m,x,_,w,k=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,S=(n=[],i=(r=e)[0],o=r[1],a=r[2],u=r[3],s=r[4],c=r[5],f=r[6],l=r[7],h=r[8],(v=i*(y=h*s-c*l)+o*(p=-h*u+c*f)+a*(g=l*u-s*f))?(v=1/v,n[0]=y*v,n[1]=(-h*o+a*l)*v,n[2]=(c*o-a*s)*v,n[3]=p*v,n[4]=(h*i-a*f)*v,n[5]=(-c*i+a*u)*v,n[6]=g*v,n[7]=(-l*i+o*f)*v,n[8]=(s*i-o*u)*v,n):null),O=[t.x,t.y,k];return m=S,x=(b=d=O)[0],_=b[1],w=b[2],d[0]=x*m[0]+_*m[3]+w*m[6],d[1]=x*m[1]+_*m[4]+w*m[7],d[2]=x*m[2]+_*m[5]+w*m[8],{x:O[0],y:O[1]}}({x:t,y:e},this.get("canvas").getMatrix())}},{key:"set",value:function(t,e){m.a.isPlainObject(t)?this._cfg=m.a.mix({},this._cfg,t):this._cfg[t]=e}},{key:"get",value:function(t){return this._cfg[t]}},{key:"findById",value:function(t){return this.get("itemMap")[t]}},{key:"tofront",value:function(t){if(!t)return new Error("未选中节点");var e=this.get("".concat(t.get("type"),"s")),n=e.indexOf(t);e.splice(n,1),e.unshift(t);var r=this.get("shapeMap")[t.get("id")],i=r.parent.children;n=i.indexOf(r),i.push(r),this.autoPaint()}},{key:"toback",value:function(t){if(!t)return new Error("未选中节点");var e=this.get("".concat(t.get("type"),"s")),n=e.indexOf(t);e.splice(n,1),e.push(t);var r=this.get("shapeMap")[t.get("id")],i=r.parent.children;n=i.indexOf(r),i.unshift(r),this.autoPaint()}},{key:"paste",value:function(t){if(!t)return new Error("未复制节点");var e=t._cfg,n={x:e.x+20,y:e.y+20,shape:e.shape,anchorMatrix:e.anchorMatrix,label:e.label,labelCfg:e.labelCfg};return this.addItem(e.type,n)}},{key:"scale",value:function(t){var e=this.get("canvas");this.set("ratio",t),e.scale(t),this.autoPaint()}},{key:"zoomin",value:function(){var t=this.get("maxRatio"),e=this.get("ratio");e=e+.2<=t?parseFloat((e+.2).toFixed(2)):t,this.scale(e)}},{key:"zoomout",value:function(){var t=this.get("minRatio"),e=this.get("ratio");e=t<=e-.2?parseFloat((e-.2).toFixed(2)):t,this.scale(e)}}])&&at(e.prototype,r),i&&at(e,i),n}(),Item:nt,registerNode:function(t,e){nt[t]=e(nt.base)}};e.a=ft},function(t,e,n){"use strict";n.r(e);var r=n(4);window.kg=r.a}]);